var ET = (function() {
	
	var my = {};
	var initialValue = "";
	var editing = false;

	my.divClicked = function () {
		if (editing) return;
		initialValue = $("#editable_text").text();
		var et = $("#text_editor");
		et.val(initialValue);
		$(".editable_text_div").hide();
		$(".text_editor_div").show();
		$("#pencil1").hide();
		et.focus();
		et.select();
		editing = true;
	}

	my.editableTextBlurred = function () {
		editing = false;
		var text = "";
		if($("#text_editor").val()!="") {
			text = $("#text_editor").text();
		}
		else {
			text = initialValue;
		}

		UU.caseUpdateFavorite();

		var viewableText = $("#editable_text");
		viewableText.text(text);
		$(".text_editor_div").hide();
		$(".editable_text_div").show();
		$("#pencil1").show();
	}
	
	my.init = function() {
		$(".fav_title_edit").click(function() {ET.divClicked()});
		$("#text_editor").blur(function() {ET.editableTextBlurred()});
		$("#text_editor").hide();
		$("#text_editor").keydown(function(event){ 
			if(event.which == '13'){
				$("#text_editor").blur();
			}
		});
	}
	
	return my;
}());