<!DOCTYPE html>
<html>
<head>
    <title>Course Prerequisites Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        #graph {
            width: 1200px;
            height: 800px;
            border: 1px solid #ccc;
        }

        .node {
            fill: #fff;
            stroke: #000;
            stroke-width: 1.5px;
        }

        .node text {
            font-size: 12px;
            font-family: sans-serif;
        }

        .link {
            fill: none;
            stroke: #999;
            stroke-width: 1.5px;
            marker-end: url(#arrowhead);
        }

        .layer1 { fill: #ffcdd2; }
        .layer2 { fill: #c8e6c9; }
        .layer3 { fill: #bbdefb; }
    </style>
</head>
<body>
    <div id="graph"></div>

    <script>
        const data = {
            nodes: [],
            links: []
        };

        // Create nodes for each unique course with layer information
        const courses = [
            {id: 'COMPSCI 1DM3', layer: 1}, {id: 'COMPSCI 1JC3', layer: 1}, 
            {id: 'COMPSCI 1MD3', layer: 1}, {id: 'COMPSCI 1XC3', layer: 1}, 
            {id: 'COMPSCI 1XD3', layer: 1}, {id: 'MATH 1B03', layer: 1},
            
            {id: 'COMPSCI 2AC3', layer: 2}, {id: 'COMPSCI 2C03', layer: 2},
            {id: 'COMPSCI 2DB3', layer: 2}, {id: 'COMPSCI 2GA3', layer: 2},
            {id: 'COMPSCI 2LC3', layer: 2}, {id: 'COMPSCI 2ME3', layer: 2},
            {id: 'COMPSCI 2SD3', layer: 2}, {id: 'COMPSCI 2XC3', layer: 2},
            {id: 'STATS 2D03', layer: 2},
            
            {id: 'COMPSCI 3AC3', layer: 3}, {id: 'COMPSCI 3DM3', layer: 3},
            {id: 'COMPSCI 3DP3', layer: 3}, {id: 'COMPSCI 3EA3', layer: 3},
            {id: 'COMPSCI 3GC3', layer: 3}, {id: 'COMPSCI 3MI3', layer: 3},
            {id: 'COMPSCI 3N03', layer: 3}, {id: 'COMPSCI 3RA3', layer: 3},
            {id: 'COMPSCI 3TB3', layer: 3}, {id: 'COMPSCI 3SH3', layer: 3},
            {id: 'COMPSCI 3VA3', layer: 3}, {id: 'COMPSCI 4E03', layer: 3},
            {id: 'COMPSCI 4EN3', layer: 3}, {id: 'COMPSCI 4HC3', layer: 3},
            {id: 'COMPSCI 4ML3', layer: 3}, {id: 'COMPSCI 4O03', layer: 3},
            {id: 'COMPSCI 4X03', layer: 3}, {id: 'COMPSCI 4Z03', layer: 3},
            {id: 'COMPSCI 4ZP6A/B', layer: 3}, {id: 'COMPSCI 4AL3', layer: 3},
            {id: 'COMPSCI 4CR3', layer: 3}, {id: 'COMPSCI 4SD3', layer: 3},
            {id: 'COMPSCI 4NL3', layer: 3}
        ];

        data.nodes = courses;

        // Complete prerequisites list
        const prerequisites = {
            'COMPSCI 1XC3': ['COMPSCI 1MD3'],
            'COMPSCI 1XD3': ['COMPSCI 1JC3', 'COMPSCI 1MD3'],
            'COMPSCI 2AC3': ['COMPSCI 2LC3', 'COMPSCI 2C03'],
            'COMPSCI 2C03': ['COMPSCI 1DM3', 'COMPSCI 1XC3'],
            'COMPSCI 2DB3': ['COMPSCI 2LC3'],
            'COMPSCI 2GA3': ['COMPSCI 1MD3'],
            'COMPSCI 2LC3': ['COMPSCI 1DM3', 'COMPSCI 1MD3'],
            'COMPSCI 2ME3': ['COMPSCI 1XC3', 'COMPSCI 1XD3'],
            'COMPSCI 2SD3': ['COMPSCI 2C03', 'COMPSCI 2LC3', 'COMPSCI 2ME3'],
            'COMPSCI 2XC3': ['COMPSCI 1XC3', 'COMPSCI 1XD3', 'COMPSCI 2C03', 'COMPSCI 2ME3'],
            'COMPSCI 3AC3': ['COMPSCI 2C03', 'COMPSCI 2AC3'],
            'COMPSCI 3DM3': ['COMPSCI 2DB3', 'COMPSCI 2C03', 'COMPSCI 2ME3', 'STATS 2D03'],
            'COMPSCI 3DP3': ['COMPSCI 2C03', 'STATS 2D03', 'MATH 1B03'],
            'COMPSCI 3EA3': ['COMPSCI 2LC3', 'COMPSCI 2AC3', 'COMPSCI 2ME3', 'COMPSCI 2SD3'],
            'COMPSCI 3GC3': ['MATH 1B03', 'COMPSCI 2C03'],
            'COMPSCI 3MI3': ['COMPSCI 2C03', 'COMPSCI 2LC3', 'COMPSCI 2AC3', 'COMPSCI 2ME3'],
            // 'COMPSCI 3N03': ['COMPSCI 3SH3'],
            // 'COMPSCI 3RA3': ['COMPSCI 2AC3', 'COMPSCI 2ME3'],
            // 'COMPSCI 3TB3': ['COMPSCI 2C03', 'COMPSCI 2AC3', 'COMPSCI 2GA3', 'COMPSCI 3MI3'],
            // 'COMPSCI 3SH3': ['COMPSCI 2SD3', 'COMPSCI 2C03', 'COMPSCI 2GA3'],
            // 'COMPSCI 4E03': ['STATS 2D03'],
            // 'COMPSCI 4HC3': ['COMPSCI 2C03'],
            // 'COMPSCI 4ML3': ['COMPSCI 2C03', 'STATS 2D03', 'COMPSCI 4O03'],
            // 'COMPSCI 4O03': ['COMPSCI 2C03'],
            // 'COMPSCI 3VA3': ['COMPSCI 1XD3', 'COMPSCI 2C03', 'COMPSCI 2DB3'],
            // 'COMPSCI 4AL3': ['COMPSCI 2C03', 'COMPSCI 2ME3', 'STATS 2D03'],
            // 'COMPSCI 4CR3': ['MATH 1B03', 'COMPSCI 1DM3', 'COMPSCI 2C03'],
            // 'COMPSCI 4SD3': ['COMPSCI 2C03', 'STATS 2D03'],
            // 'COMPSCI 4NL3': ['COMPSCI 2C03', 'MATH 1B03', 'STATS 2D03']
        };

        Object.entries(prerequisites).forEach(([course, prereqs]) => {
            prereqs.forEach(prereq => {
                data.links.push({
                    source: prereq,
                    target: course
                });
            });
        });

        // Set up the SVG
        const width = 1200;
        const height = 800;
        const layerHeight = height / 4; // Divide height into 4 sections

        const svg = d3.select("#graph")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        // Add arrow marker
        svg.append("defs").append("marker")
            .attr("id", "arrowhead")
            .attr("viewBox", "0 -5 10 10")
            .attr("refX", 15)
            .attr("refY", 0)
            .attr("markerWidth", 8)
            .attr("markerHeight", 8)
            .attr("orient", "auto")
            .append("path")
            .attr("d", "M0,-5L10,0L0,5")
            .attr("fill", "#999");

        // Create the force simulation with layer constraints
        const simulation = d3.forceSimulation(data.nodes)
            .force("link", d3.forceLink(data.links).id(d => d.id).distance(100))
            .force("charge", d3.forceManyBody().strength(-300))
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("y", d3.forceY().y(d => {
                // Position nodes based on their layer
                return layerHeight * (d.layer - 0.5);
            }).strength(1));

        // Draw the links
        const link = svg.append("g")
            .selectAll("line")
            .data(data.links)
            .join("line")
            .attr("class", "link");

        // Draw the nodes
        const node = svg.append("g")
            .selectAll("g")
            .data(data.nodes)
            .join("g")
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        node.append("circle")
            .attr("class", d => `node layer${d.layer}`)
            .attr("r", 5);

        node.append("text")
            .text(d => d.id)
            .attr("x", 8)
            .attr("y", 3);

        // Update positions on each tick
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("transform", d => `translate(${d.x},${d.y})`);
        });

        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }
    </script>
</body>
</html>


